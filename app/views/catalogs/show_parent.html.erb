<!-- Header render -->
<%= render :partial => "partials/head" %>
<!-- /Header render -->

<!-- Catalog wrapper -->
<div id="catalog-page-wrapper" class="f-height catalog-page-index">
  <div class="g12 pd-me">
    <h1>Каталог продукції</h1>
  </div>
  <div class="catalog-block g4 alpha">
    <%= render :partial => "partials/catalog_navigation" %>
  </div><!-- Catalog wrap stuff G4 -->
  <!-- Lets count have many childs we got -->
  <script type="text/javascript" charset="utf-8">
    $(document).ready(function() {
      var child_count = <%= fetch_all_child(@parent_catalog.id).count %>;
      var child_width = child_count * 217;
      console.log('Height of tabs is '+child_width);

      $(".child-tabs").css({
        width: child_width
      });
    });
  </script>
  <div id="catalog-content">
  <div id="catalog-parent" class="g8 catalog-page-format omega">
    <h1><%= @parent_catalog.name %></h1>
    <div id="tab-control">
    <div class="tab-wrapper">
      <!--<div class="tabs-left animate"> < </div>-->
      <!--<div class="tabs-right animate"> > </div>-->
      <div class="child-tabs">
        <% fetch_all_child(@parent_catalog.id).each do |child_tabs| %>
          <div class="tab-item" id="tab-<%= child_tabs.id %>" data-child-name="<%= child_tabs.name %>" data-slug="<%= child_tabs.slug %>">
            <span><% if child_tabs.avatar.present? %><%= image_tag(child_tabs.avatar.url(:tab), :alt => child_tabs.name) %><% else %><%= child_tabs.name %><% end %></span>
          </div>
        <% end %>
      </div>
    </div>
    
    <div id="tabcontents">
      <% fetch_all_child(@parent_catalog.id).each do |child_tab_content| %>
      <div class="tab-content-wrapper" id="tab-content-<%= child_tab_content.id %>">
        <%= child_tab_content.inspect %>
        <%= child_tab_content.description.html_safe unless child_tab_content.description.blank? %>

      <div id="all-products-by-childs">
      <div class="store-section"><!-- Online store -->
        <div class="top-border">&nbsp;</div>
        <%# @parent_catalog.child_catalogs.each do |product_item| %>
          <% fetch_all_products(child_tab_content.id).each do |pr| %>
              <div class="online-item" data-id="" data-catalog-name="" data-price="">
                <%= image_tag(pr.avatar.url(:thumb), :alt => pr.name) %>
                <p><%= pr.name %></p>
                <%#= link_to_if pr.slug.present?, 'Детальніше', @parent_catalog.slug+'/'+product_item.slug+'/'+pr.slug, :title => pr.name, :class => 'submit-branded animate' %>
              </div>
          <% end %>
        <%# end %>
      </div> <!-- /Online store -->
    </div> <!-- /products -->
      </div>
    <% end %>
  </div>
</div><!-- /tab-control -->
    
  </div>

</div> <!-- / div#catalog-content -->

</div>
<!-- /Catalog wrapper -->
<div class="pd-me f-height"></div>

<!-- Sponsor render -->
<%= render :partial => "partials/sponsor-all" %>
<!-- Sponsor render -->

<!-- Footer render -->
<%= render :partial => "partials/footer" %>
<!-- /Footer render -->
